<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project 2 - Fun with Filters and Frequencies!</title>
    <link rel="stylesheet" href="../styles.css">
    <style>
        .back-link {
            display: inline-block;
            margin-bottom: 1.5rem;
            color: #007bff;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.2s ease;
        }

        .back-link:hover {
            color: #0056b3;
        }

        .content {
            max-width: 1400px;
        }

        .project-title {
            font-size: 2.2rem;
            color: #2c3e50;
            margin-bottom: 0.5rem;
        }

        .project-description {
            color: #6c757d;
            font-size: 1.1rem;
            margin-bottom: 2rem;
        }

        .task-section {
            margin-bottom: 3rem;
        }

        .task-title {
            font-size: 1.5rem;
            color: #2c3e50;
            margin-bottom: 1rem;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 0.5rem;
        }

        .image-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 1rem;
            width: 100%;
        }

        .image-item {
            text-align: center;
        }

        .image-item img {
            width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .image-caption {
            font-size: 0.6rem;
            color: #6c757d;
            margin-top: 0.5rem;
            line-height: 1.3;
        }

        .image-name {
            font-weight: bold;
            font-size: 0.7rem;
            color: #2c3e50;
            margin-bottom: 0.2rem;
        }

        .gif-item {
            text-align: left;
        }

        .gif-item img {
            max-width: 400px;
            width: 100%;
        }

        .code-block {
            background-color: #e5e5e5;
            color: #170056;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 1rem 1rem 1rem 0rem;
            margin: 1rem 0;
            overflow-x: auto;
            font-family: 'Monaco', 'Consolas', 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.4;
        }

    </style>
</head>
<body>
    <a href="../index.html" class="back-link">‚Üê Back to Portfolio</a>
    <div class="content">
        <h1 class="project-title">Project 2</h1>
        <p class="project-description">Fun with Filters and Frequencies!</p>
        
        <div class="task-section">
            <h2 class="task-title">Task 1.1 - Convolutions from Scratch!</h2>
            <pre class="code-block"><code>
                def convolve_four(image, kernel, padding = True):
                    if padding:
                        pad_h = kernel.shape[0] // 2
                        pad_w = kernel.shape[1] // 2
                        padded_image = np.pad(image, ((pad_h, pad_h), (pad_w, pad_w)), mode = 'constant', constant_values = 0)
                    else:
                        padded_image = image
                    
                    out_h = padded_image.shape[0] - kernel.shape[0] + 1
                    out_w = padded_image.shape[1] - kernel.shape[1] + 1
                    output = np.zeros((out_h, out_w))

                    for i in range(out_h):
                        for j in range(out_w):
                            for ki in range(kernel.shape[0]):
                                for kj in range(kernel.shape[1]):
                                    output[i, j] += padded_image[i + ki, j + kj] * kernel[ki, kj]

                    return output

                def convolve_two(image, kernel, padding = True):
                    if padding:
                        pad_h = kernel.shape[0] // 2
                        pad_w = kernel.shape[1] // 2
                        padded_image = np.pad(image, ((pad_h, pad_h), (pad_w, pad_w)), mode = 'constant', constant_values = 0)
                    else:
                        padded_image = image
                    
                    out_h = padded_image.shape[0] - kernel.shape[0] + 1
                    out_w = padded_image.shape[1] - kernel.shape[1] + 1
                    output = np.zeros((out_h, out_w))

                    for i in range(out_h):
                        for j in range(out_w):
                            region = padded_image[i:i + kernel.shape[0], j:j + kernel.shape[1]]
                            output[i, j] = np.sum(region * kernel)
                    
                    return output

                from scipy.signal import convolve2d

                test_image = np.random.rand(100, 100)
                test_kernel = np.ones((5, 5)) / 25

                start_time = time.time()
                result_four = convolve_four(test_image, test_kernel, padding = True)
                time_four = time.time() - start_time

                start_time = time.time()
                result_two = convolve_two(test_image, test_kernel, padding = True)
                time_two = time.time() - start_time

                start_time = time.time()
                result_scipy = convolve2d(test_image, test_kernel, mode = 'same', boundary = 'fill', fillvalue = 0)
                time_scipy = time.time() - start_time

                print(f"Test Four Loop Time: {time_four}")
                print(f"Test Two Loop Time: {time_two}")
                print(f"Test Scipy Time: {time_scipy}")                                         
            </code></pre>
            <p><em>Test Four Loop Time: 0.17535185813903809<br>Test Two Loop Time: 0.0773160457611084<br>Test Scipy Time: 0.0</em></p>
            <br>
            <p>The runtime varies across the different approaches, with the two-loop approach being significantly faster than the four-loop approach (more than 2x speedup), and the scipy approach being dramatically faster than both manually implemented approaches.<br><br> In our manual approaches, boundaries are handled with zero-padding. The scipy approach does the same thing when provided with the correct function parameters.</p>
            <img src="images/1.1.png" alt="1.1" style="width: 100%; max-width: 800px; margin-top: 1rem;">
        </div>

        <div class="task-section">
            <h2 class="task-title">Task 1.2 - Finite Difference Operator</h2>
            <img src="images/1.2.1.png" alt="1.2.1" style="width: 100%; max-width: 800px; margin-top: 1rem;">
            <img src="images/1.2.2.png" alt="1.2.2" style="width: 100%; max-width: 800px; margin-top: 1rem;">
            <br>
            <p>I made a tradeoff in finding all edges vs. eliminating all noise, where I chose to prioritize eliminating noise over finding every possible edge. I did this because in the image above, there is very little noise, and all of the prominent edges in the image are captured. The edges that are omitted are mostly from the background, which isn't as relevant to the subject of the image (the cameraman).</p>
        </div>

        <div class="task-section">
            <h2 class="task-title">Task 1.3 - Derivative of Gaussian (DoG) Filter</h2>
            <img src="images/1.3.1.png" alt="1.3.1" style="width: 100%; max-width: 800px; margin-top: 1rem;">
            <br>
            <p>The differences I see are that the noise is much less pronounced in the case of using the Gaussian smoothing before computing the Dx, Dy, and Gradient Magnitude images. The edges are also smoother, and the threshold for creating a good edge image is lower than in the non-smoothed case, because the signal-to-noise ratio is now better.</p>
            <img src="images/1.3.2.png" alt="1.3.2" style="width: 100%; max-width: 800px; margin-top: 1rem;">
            <img src="images/1.3.3.png" alt="1.3.3" style="width: 100%; max-width: 800px; margin-top: 1rem;">
            <br>
            <p>We see the same results with a single convolution instead of two.</p>
        </div>

        <div class="task-section">
            <h2 class="task-title">Task 2.1 - Image "Sharpening"</h2>
            <p>The unsharp mask filter works by blurring the original image (removing high frequencies), then subtracting the blur from the original (isolating the high frequencies / edges), amplifies these high frequencies, and adds them back to the original image. This serves to accentuate the higher frequencies in the image, which usually correspond to edges. It amplifies the difference between these pixels and their neighbors. A higher alpha / sharp value means more amplification / sharpening.</p>
            <img src="images/2.1.1.png" alt="2.1.1" style="width: 100%; max-width: 800px; margin-top: 1rem;">
            <img src="images/2.1.2.png" alt="2.1.2" style="width: 100%; max-width: 800px; margin-top: 1rem;">
            <img src="images/2.1.3.png" alt="2.1.3" style="width: 100%; max-width: 800px; margin-top: 1rem;">
            <img src="images/2.1.4.png" alt="2.1.4" style="width: 100%; max-width: 800px; margin-top: 1rem;">
            <br>
            <p>When we try this strategy of blurring then sharpening an already sharp image (like the one above), we end up with an image that looks "too" sharp. It's contrast is too high and it looks strange.</p>
            <img src="images/2.1.5.png" alt="2.1.5" style="width: 100%; max-width: 800px; margin-top: 1rem;">
        </div>

        <div class="task-section">
            <h2 class="task-title">Task 2.2 - Hybrid Images</h2>
            <img src="images/2.2.1.jpeg" alt="2.2.1" style="width: 100%; max-width: 800px; margin-top: 1rem;">
            <img src="images/2.2.2.jpeg" alt="2.2.2" style="width: 100%; max-width: 800px; margin-top: 1rem;">
            <img src="images/2.2.3.png" alt="2.2.3" style="width: 100%; max-width: 800px; margin-top: 1rem;">
            <br>
            <p>I chose cutoff frequencies of 16 for Image 1 (Golden) and 8 for Image 2 (Einstein) empirically, as these yielded the best results.</p>
        </div>

        <div class="task-section">
            <h2 class="task-title">Task 2.3 - Gaussian and Laplacian Stacks & Task 2.4 - Multiresolution Blending (a.k.a. the oraple!)</h2>
            <img src="images/2.3.0.png" alt="2.3.0" style="width: 100%; max-width: 400px; margin-top: 1rem;">
            <img src="images/2.3.1.png" alt="2.3.1" style="width: 100%; max-width: 800px; margin-top: 1rem;">
            <img src="images/2.3.2.png" alt="2.3.2" style="width: 100%; max-width: 800px; margin-top: 1rem;">
            <img src="images/2.3.3.png" alt="2.3.3" style="width: 100%; max-width: 800px; margin-top: 1rem;">
            <img src="images/2.3.4.png" alt="2.3.4" style="width: 100%; max-width: 800px; margin-top: 1rem;">
            <img src="images/2.3.5.png" alt="2.3.5" style="width: 100%; max-width: 800px; margin-top: 1rem;">
            <img src="images/2.3.3.2.png" alt="2.3.3.2" style="width: 100%; max-width: 800px; margin-top: 1rem;">
            <img src="images/2.3.3.3.png" alt="2.3.3.3" style="width: 100%; max-width: 800px; margin-top: 1rem;">
        </div>
    </div>
</body>
</html>